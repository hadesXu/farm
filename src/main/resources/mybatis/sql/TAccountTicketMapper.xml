<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hades.farm.core.data.mapper.TAccountTicketMapper">
    <resultMap id="BaseResultMap" type="com.hades.farm.core.data.entity.TAccountTicket">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <constructor>
            <idArg column="id" jdbcType="BIGINT" javaType="java.lang.Long"/>
            <arg column="user_id" jdbcType="BIGINT" javaType="java.lang.Long"/>
            <arg column="balance" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
            <arg column="frozen" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
            <arg column="acc_recharge" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
            <arg column="acc_withdraw" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
            <arg column="acc_profit" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
            <arg column="acc_commission" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
            <arg column="add_time" jdbcType="TIMESTAMP" javaType="java.util.Date"/>
            <arg column="update_time" jdbcType="TIMESTAMP" javaType="java.util.Date"/>
        </constructor>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        id, user_id, balance, frozen, acc_recharge, acc_withdraw, acc_profit, acc_commission,
        add_time, update_time
    </sql>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        from t_account_ticket
        where id = #{id,jdbcType=BIGINT}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from t_account_ticket
        where id = #{id,jdbcType=BIGINT}
    </delete>
    <insert id="insert" parameterType="com.hades.farm.core.data.entity.TAccountTicket">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into t_account_ticket (id, user_id, balance,
        frozen, acc_recharge, acc_withdraw,
        acc_profit, acc_commission, add_time,
        update_time)
        values (#{id,jdbcType=BIGINT}, #{userId,jdbcType=BIGINT}, #{balance,jdbcType=DECIMAL},
        #{frozen,jdbcType=DECIMAL}, #{accRecharge,jdbcType=DECIMAL}, #{accWithdraw,jdbcType=DECIMAL},
        #{accProfit,jdbcType=DECIMAL}, #{accCommission,jdbcType=DECIMAL}, #{addTime,jdbcType=TIMESTAMP},
        #{updateTime,jdbcType=TIMESTAMP})
    </insert>
    <insert id="insertSelective" parameterType="com.hades.farm.core.data.entity.TAccountTicket">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into t_account_ticket
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="userId != null">
                user_id,
            </if>
            <if test="balance != null">
                balance,
            </if>
            <if test="frozen != null">
                frozen,
            </if>
            <if test="accRecharge != null">
                acc_recharge,
            </if>
            <if test="accWithdraw != null">
                acc_withdraw,
            </if>
            <if test="accProfit != null">
                acc_profit,
            </if>
            <if test="accCommission != null">
                acc_commission,
            </if>
            <if test="addTime != null">
                add_time,
            </if>
            <if test="updateTime != null">
                update_time,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=BIGINT},
            </if>
            <if test="userId != null">
                #{userId,jdbcType=BIGINT},
            </if>
            <if test="balance != null">
                #{balance,jdbcType=DECIMAL},
            </if>
            <if test="frozen != null">
                #{frozen,jdbcType=DECIMAL},
            </if>
            <if test="accRecharge != null">
                #{accRecharge,jdbcType=DECIMAL},
            </if>
            <if test="accWithdraw != null">
                #{accWithdraw,jdbcType=DECIMAL},
            </if>
            <if test="accProfit != null">
                #{accProfit,jdbcType=DECIMAL},
            </if>
            <if test="accCommission != null">
                #{accCommission,jdbcType=DECIMAL},
            </if>
            <if test="addTime != null">
                #{addTime,jdbcType=TIMESTAMP},
            </if>
            <if test="updateTime != null">
                #{updateTime,jdbcType=TIMESTAMP},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.hades.farm.core.data.entity.TAccountTicket">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update t_account_ticket
        <set>
            <if test="userId != null">
                user_id = #{userId,jdbcType=BIGINT},
            </if>
            <if test="balance != null">
                balance = #{balance,jdbcType=DECIMAL},
            </if>
            <if test="frozen != null">
                frozen = #{frozen,jdbcType=DECIMAL},
            </if>
            <if test="accRecharge != null">
                acc_recharge = #{accRecharge,jdbcType=DECIMAL},
            </if>
            <if test="accWithdraw != null">
                acc_withdraw = #{accWithdraw,jdbcType=DECIMAL},
            </if>
            <if test="accProfit != null">
                acc_profit = #{accProfit,jdbcType=DECIMAL},
            </if>
            <if test="accCommission != null">
                acc_commission = #{accCommission,jdbcType=DECIMAL},
            </if>
            <if test="addTime != null">
                add_time = #{addTime,jdbcType=TIMESTAMP},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime,jdbcType=TIMESTAMP},
            </if>
        </set>
        where id = #{id,jdbcType=BIGINT}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.hades.farm.core.data.entity.TAccountTicket">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update t_account_ticket
        set user_id = #{userId,jdbcType=BIGINT},
        balance = #{balance,jdbcType=DECIMAL},
        frozen = #{frozen,jdbcType=DECIMAL},
        acc_recharge = #{accRecharge,jdbcType=DECIMAL},
        acc_withdraw = #{accWithdraw,jdbcType=DECIMAL},
        acc_profit = #{accProfit,jdbcType=DECIMAL},
        acc_commission = #{accCommission,jdbcType=DECIMAL},
        add_time = #{addTime,jdbcType=TIMESTAMP},
        update_time = #{updateTime,jdbcType=TIMESTAMP}
        where id = #{id,jdbcType=BIGINT}
    </update>

    <update id="updateAccountTicket"
            parameterType="com.hades.farm.core.data.dto.requestDto.UpdateAccountTicketRequestDto">
        update t_account_ticket set
        <if test="acctOpreType == 5 or acctOpreType == 6 or acctOpreType == 8">
            balance = balance + #{balance,jdbcType=DECIMAL},
        </if>
        <if test="acctOpreType == 1 or acctOpreType == 2 or acctOpreType == 7
      or acctOpreType == 9 or acctOpreType == 10 ">
            balance = balance - #{balance,jdbcType=DECIMAL},
        </if>
        update_time = now()
        where user_id = #{userId,jdbcType=BIGINT}
        <if test="acctOpreType == 1 or acctOpreType == 2 or acctOpreType == 7
      or acctOpreType == 9 or acctOpreType == 10 ">
            and balance &gt;= #{balance,jdbcType=DECIMAL}
        </if>
    </update>


    <select id="queryAccountByUserId" resultMap="BaseResultMap" parameterType="java.lang.Long">
        select
        <include refid="Base_Column_List"/>
        from t_account_ticket
        where user_id = #{userId,jdbcType=BIGINT}
    </select>

    <update id="incUserAccount" parameterType="com.hades.farm.core.data.entity.TAccountTicket">
     SET balance = balance + #{balance},
            frozen = frozen + #{frozen},
            acc_recharge = acc_recharge + #{accRecharge},
            acc_withdraw = acc_withdraw + #{accWithdraw},
            acc_profit = acc_profit + #{accProfit},
            acc_commission = acc_commission + #{accCommission}
        where user_id = #{userId}
                and (balance + #{balance,jdbcType=DECIMAL}) >0
  </update>

</mapper>